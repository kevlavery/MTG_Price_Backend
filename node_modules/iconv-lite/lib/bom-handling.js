"use strict";

var BOMChar = '\uFEFF';

exports.PrependBOM = PrependBOMWrapper
function PrependBOMWrapper(encoder, options) ***REMOVED***
    this.encoder = encoder;
    this.addBOM = true;
***REMOVED***

PrependBOMWrapper.prototype.write = function(str) ***REMOVED***
    if (this.addBOM) ***REMOVED***
        str = BOMChar + str;
        this.addBOM = false;
    ***REMOVED***

    return this.encoder.write(str);
***REMOVED***

PrependBOMWrapper.prototype.end = function() ***REMOVED***
    return this.encoder.end();
***REMOVED***


//------------------------------------------------------------------------------

exports.StripBOM = StripBOMWrapper;
function StripBOMWrapper(decoder, options) ***REMOVED***
    this.decoder = decoder;
    this.pass = false;
    this.options = options || ***REMOVED******REMOVED***;
***REMOVED***

StripBOMWrapper.prototype.write = function(buf) ***REMOVED***
    var res = this.decoder.write(buf);
    if (this.pass || !res)
        return res;

    if (res[0] === BOMChar) ***REMOVED***
        res = res.slice(1);
        if (typeof this.options.stripBOM === 'function')
            this.options.stripBOM();
    ***REMOVED***

    this.pass = true;
    return res;
***REMOVED***

StripBOMWrapper.prototype.end = function() ***REMOVED***
    return this.decoder.end();
***REMOVED***

