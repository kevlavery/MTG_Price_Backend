/* eslint-disable node/no-deprecated-api */

'use strict'

var buffer = require('buffer')
var Buffer = buffer.Buffer

var safer = ***REMOVED******REMOVED***

var key

for (key in buffer) ***REMOVED***
  if (!buffer.hasOwnProperty(key)) continue
  if (key === 'SlowBuffer' || key === 'Buffer') continue
  safer[key] = buffer[key]
***REMOVED***

var Safer = safer.Buffer = ***REMOVED******REMOVED***
for (key in Buffer) ***REMOVED***
  if (!Buffer.hasOwnProperty(key)) continue
  if (key === 'allocUnsafe' || key === 'allocUnsafeSlow') continue
  Safer[key] = Buffer[key]
***REMOVED***

safer.Buffer.prototype = Buffer.prototype

if (!Safer.from || Safer.from === Uint8Array.from) ***REMOVED***
  Safer.from = function (value, encodingOrOffset, length) ***REMOVED***
    if (typeof value === 'number') ***REMOVED***
      throw new TypeError('The "value" argument must not be of type number. Received type ' + typeof value)
    ***REMOVED***
    if (value && typeof value.length === 'undefined') ***REMOVED***
      throw new TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type ' + typeof value)
    ***REMOVED***
    return Buffer(value, encodingOrOffset, length)
  ***REMOVED***
***REMOVED***

if (!Safer.alloc) ***REMOVED***
  Safer.alloc = function (size, fill, encoding) ***REMOVED***
    if (typeof size !== 'number') ***REMOVED***
      throw new TypeError('The "size" argument must be of type number. Received type ' + typeof size)
    ***REMOVED***
    if (size < 0 || size >= 2 * (1 << 30)) ***REMOVED***
      throw new RangeError('The value "' + size + '" is invalid for option "size"')
    ***REMOVED***
    var buf = Buffer(size)
    if (!fill || fill.length === 0) ***REMOVED***
      buf.fill(0)
    ***REMOVED*** else if (typeof encoding === 'string') ***REMOVED***
      buf.fill(fill, encoding)
    ***REMOVED*** else ***REMOVED***
      buf.fill(fill)
    ***REMOVED***
    return buf
  ***REMOVED***
***REMOVED***

if (!safer.kStringMaxLength) ***REMOVED***
  try ***REMOVED***
    safer.kStringMaxLength = process.binding('buffer').kStringMaxLength
  ***REMOVED*** catch (e) ***REMOVED***
    // we can't determine kStringMaxLength in environments where process.binding
    // is unsupported, so let's not set it
  ***REMOVED***
***REMOVED***

if (!safer.constants) ***REMOVED***
  safer.constants = ***REMOVED***
    MAX_LENGTH: safer.kMaxLength
  ***REMOVED***
  if (safer.kStringMaxLength) ***REMOVED***
    safer.constants.MAX_STRING_LENGTH = safer.kStringMaxLength
  ***REMOVED***
***REMOVED***

module.exports = safer
