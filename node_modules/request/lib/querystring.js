'use strict'

var qs = require('qs')
var querystring = require('querystring')

function Querystring (request) ***REMOVED***
  this.request = request
  this.lib = null
  this.useQuerystring = null
  this.parseOptions = null
  this.stringifyOptions = null
***REMOVED***

Querystring.prototype.init = function (options) ***REMOVED***
  if (this.lib) ***REMOVED*** return ***REMOVED***

  this.useQuerystring = options.useQuerystring
  this.lib = (this.useQuerystring ? querystring : qs)

  this.parseOptions = options.qsParseOptions || ***REMOVED******REMOVED***
  this.stringifyOptions = options.qsStringifyOptions || ***REMOVED******REMOVED***
***REMOVED***

Querystring.prototype.stringify = function (obj) ***REMOVED***
  return (this.useQuerystring)
    ? this.rfc3986(this.lib.stringify(obj,
      this.stringifyOptions.sep || null,
      this.stringifyOptions.eq || null,
      this.stringifyOptions))
    : this.lib.stringify(obj, this.stringifyOptions)
***REMOVED***

Querystring.prototype.parse = function (str) ***REMOVED***
  return (this.useQuerystring)
    ? this.lib.parse(str,
      this.parseOptions.sep || null,
      this.parseOptions.eq || null,
      this.parseOptions)
    : this.lib.parse(str, this.parseOptions)
***REMOVED***

Querystring.prototype.rfc3986 = function (str) ***REMOVED***
  return str.replace(/[!'()*]/g, function (c) ***REMOVED***
    return '%' + c.charCodeAt(0).toString(16).toUpperCase()
  ***REMOVED***)
***REMOVED***

Querystring.prototype.unescape = querystring.unescape

exports.Querystring = Querystring
