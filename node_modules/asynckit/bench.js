/* eslint no-console: "off" */

var asynckit = require('./')
  , async    = require('async')
  , assert   = require('assert')
  , expected = 0
  ;

var Benchmark = require('benchmark');
var suite = new Benchmark.Suite;

var source = [];
for (var z = 1; z < 100; z++)
***REMOVED***
  source.push(z);
  expected += z;
***REMOVED***

suite
// add tests

.add('async.map', function(deferred)
***REMOVED***
  var total = 0;

  async.map(source,
  function(i, cb)
  ***REMOVED***
    setImmediate(function()
    ***REMOVED***
      total += i;
      cb(null, total);
    ***REMOVED***);
  ***REMOVED***,
  function(err, result)
  ***REMOVED***
    assert.ifError(err);
    assert.equal(result[result.length - 1], expected);
    deferred.resolve();
  ***REMOVED***);
***REMOVED***, ***REMOVED***'defer': true***REMOVED***)


.add('asynckit.parallel', function(deferred)
***REMOVED***
  var total = 0;

  asynckit.parallel(source,
  function(i, cb)
  ***REMOVED***
    setImmediate(function()
    ***REMOVED***
      total += i;
      cb(null, total);
    ***REMOVED***);
  ***REMOVED***,
  function(err, result)
  ***REMOVED***
    assert.ifError(err);
    assert.equal(result[result.length - 1], expected);
    deferred.resolve();
  ***REMOVED***);
***REMOVED***, ***REMOVED***'defer': true***REMOVED***)


// add listeners
.on('cycle', function(ev)
***REMOVED***
  console.log(String(ev.target));
***REMOVED***)
.on('complete', function()
***REMOVED***
  console.log('Fastest is ' + this.filter('fastest').map('name'));
***REMOVED***)
// run async
.run(***REMOVED*** 'async': true ***REMOVED***);
