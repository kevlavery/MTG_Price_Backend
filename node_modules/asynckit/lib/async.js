var defer = require('./defer.js');

// API
module.exports = async;

/**
 * Runs provided callback asynchronously
 * even if callback itself is not
 *
 * @param   ***REMOVED***function***REMOVED*** callback - callback to invoke
 * @returns ***REMOVED***function***REMOVED*** - augmented callback
 */
function async(callback)
***REMOVED***
  var isAsync = false;

  // check if async happened
  defer(function() ***REMOVED*** isAsync = true; ***REMOVED***);

  return function async_callback(err, result)
  ***REMOVED***
    if (isAsync)
    ***REMOVED***
      callback(err, result);
    ***REMOVED***
    else
    ***REMOVED***
      defer(function nextTick_callback()
      ***REMOVED***
        callback(err, result);
      ***REMOVED***);
    ***REMOVED***
  ***REMOVED***;
***REMOVED***
