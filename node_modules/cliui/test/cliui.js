/* global describe, it */

require('chai').should()

var cliui = require('../')

describe('cliui', function () ***REMOVED***
  describe('div', function () ***REMOVED***
    it("wraps text at 'width' if a single column is given", function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 10
      ***REMOVED***)

      ui.div('i am a string that should be wrapped')

      ui.toString().split('\n').forEach(function (row) ***REMOVED***
        row.length.should.be.lte(10)
      ***REMOVED***)
    ***REMOVED***)

    it('evenly divides text across columns if multiple columns are given', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.div(
        ***REMOVED***text: 'i am a string that should be wrapped', width: 15***REMOVED***,
        'i am a second string that should be wrapped',
        'i am a third string that should be wrapped'
      )

      // total width of all columns is <=
      // the width cliui is initialized with.
      ui.toString().split('\n').forEach(function (row) ***REMOVED***
        row.length.should.be.lte(40)
      ***REMOVED***)

      // it should wrap each column appropriately.
      var expected = [
       'i am a string  i am a      i am a third',
       'that should be second      string that',
       'wrapped        string that should be',
       '               should be   wrapped',
       '               wrapped'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('allows for a blank row to be appended', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.div()

      // it should wrap each column appropriately.
      var expected = ['']

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)
  ***REMOVED***)

  describe('_columnWidths', function () ***REMOVED***
    it('uses same width for each column by default', function () ***REMOVED***
      var ui = cliui(***REMOVED***
          width: 40
        ***REMOVED***),
        widths = ui._columnWidths([***REMOVED******REMOVED***, ***REMOVED******REMOVED***, ***REMOVED******REMOVED***])

      widths[0].should.equal(13)
      widths[1].should.equal(13)
      widths[2].should.equal(13)
    ***REMOVED***)

    it('divides width over remaining columns if first column has width specified', function () ***REMOVED***
      var ui = cliui(***REMOVED***
          width: 40
        ***REMOVED***),
        widths = ui._columnWidths([***REMOVED***width: 20***REMOVED***, ***REMOVED******REMOVED***, ***REMOVED******REMOVED***])

      widths[0].should.equal(20)
      widths[1].should.equal(10)
      widths[2].should.equal(10)
    ***REMOVED***)

    it('divides width over remaining columns if middle column has width specified', function () ***REMOVED***
      var ui = cliui(***REMOVED***
          width: 40
        ***REMOVED***),
        widths = ui._columnWidths([***REMOVED******REMOVED***, ***REMOVED***width: 10***REMOVED***, ***REMOVED******REMOVED***])

      widths[0].should.equal(15)
      widths[1].should.equal(10)
      widths[2].should.equal(15)
    ***REMOVED***)

    it('keeps track of remaining width if multiple columns have width specified', function () ***REMOVED***
      var ui = cliui(***REMOVED***
          width: 40
        ***REMOVED***),
        widths = ui._columnWidths([***REMOVED***width: 20***REMOVED***, ***REMOVED***width: 12***REMOVED***, ***REMOVED******REMOVED***])

      widths[0].should.equal(20)
      widths[1].should.equal(12)
      widths[2].should.equal(8)
    ***REMOVED***)

    it('uses a sane default if impossible widths are specified', function () ***REMOVED***
      var ui = cliui(***REMOVED***
          width: 40
        ***REMOVED***),
        widths = ui._columnWidths([***REMOVED***width: 30***REMOVED***, ***REMOVED***width: 30***REMOVED***, ***REMOVED***padding: [0, 2, 0, 1]***REMOVED***])

      widths[0].should.equal(30)
      widths[1].should.equal(30)
      widths[2].should.equal(4)
    ***REMOVED***)
  ***REMOVED***)

  describe('alignment', function () ***REMOVED***
    it('allows a column to be right aligned', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.div(
        'i am a string',
        ***REMOVED***text: 'i am a second string', align: 'right'***REMOVED***,
        'i am a third string that should be wrapped'
      )

      // it should right-align the second column.
      var expected = [
       'i am a stringi am a secondi am a third',
       '                    stringstring that',
       '                          should be',
       '                          wrapped'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('allows a column to be center aligned', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 60
      ***REMOVED***)

      ui.div(
        'i am a string',
        ***REMOVED***text: 'i am a second string', align: 'center', padding: [0, 2, 0, 2]***REMOVED***,
        'i am a third string that should be wrapped'
      )

      // it should right-align the second column.
      var expected = [
       'i am a string          i am a second       i am a third string',
       '                           string          that should be',
       '                                           wrapped'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)
  ***REMOVED***)

  describe('padding', function () ***REMOVED***
    it('handles left/right padding', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.div(
        ***REMOVED***text: 'i have padding on my left', padding: [0, 0, 0, 4]***REMOVED***,
        ***REMOVED***text: 'i have padding on my right', padding: [0, 2, 0, 0], align: 'center'***REMOVED***,
        ***REMOVED***text: 'i have no padding', padding: [0, 0, 0, 0]***REMOVED***
      )

      // it should add left/right padding to columns.
      var expected = [
       '    i have     i have      i have no',
       '    padding  padding on    padding',
       '    on my     my right',
       '    left'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('handles top/bottom padding', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.div(
        'i am a string',
        ***REMOVED***text: 'i am a second string', padding: [2, 0, 0, 0]***REMOVED***,
        ***REMOVED***text: 'i am a third string that should be wrapped', padding: [0, 0, 1, 0]***REMOVED***
      )

      // it should add top/bottom padding to second
      // and third columns.
      var expected = [
       'i am a string             i am a third',
       '                          string that',
       '             i am a secondshould be',
       '             string       wrapped',
       ''
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)
  ***REMOVED***)

  describe('wrap', function () ***REMOVED***
    it('allows wordwrap to be disabled', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        wrap: false
      ***REMOVED***)

      ui.div(
        ***REMOVED***text: 'i am a string', padding: [0, 1, 0, 0]***REMOVED***,
        ***REMOVED***text: 'i am a second string', padding: [0, 2, 0, 0]***REMOVED***,
        ***REMOVED***text: 'i am a third string that should not be wrapped', padding: [0, 0, 0, 2]***REMOVED***
      )

      ui.toString().should.equal('i am a string i am a second string    i am a third string that should not be wrapped')
    ***REMOVED***)
  ***REMOVED***)

  describe('span', function () ***REMOVED***
    it('appends the next row to the end of the prior row if it fits', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.span(
        ***REMOVED***text: 'i am a string that will be wrapped', width: 30***REMOVED***
      )

      ui.div(
        ***REMOVED***text: ' [required] [default: 99]', align: 'right'***REMOVED***
      )

      var expected = [
       'i am a string that will be',
       'wrapped         [required] [default: 99]'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('does not append the string if it does not fit on the prior row', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.span(
        ***REMOVED***text: 'i am a string that will be wrapped', width: 30***REMOVED***
      )

      ui.div(
        ***REMOVED***text: 'i am a second row', align: 'left'***REMOVED***
      )

      var expected = [
       'i am a string that will be',
       'wrapped',
       'i am a second row'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('always appends text to prior span if wrap is disabled', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        wrap: false,
        width: 40
      ***REMOVED***)

      ui.span(
        ***REMOVED***text: 'i am a string that will be wrapped', width: 30***REMOVED***
      )

      ui.div(
        ***REMOVED***text: 'i am a second row', align: 'left', padding: [0, 0, 0, 3]***REMOVED***
      )

      ui.div('a third line')

      var expected = [
       'i am a string that will be wrapped   i am a second row',
       'a third line'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)
  ***REMOVED***)

  describe('layoutDSL', function () ***REMOVED***
    it('turns tab into multiple columns', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 60
      ***REMOVED***)

      ui.div(
        '  <regex>  \tmy awesome regex\n  <my second thing>  \tanother row\t  a third column'
      )

      var expected = [
       '  <regex>            my awesome regex',
       '  <my second thing>  another row          a third column'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('turns newline into multiple rows', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40
      ***REMOVED***)

      ui.div(
        'Usage: $0\n  <regex>\t  my awesome regex\n  <glob>\t  my awesome glob\t  [required]'
      )
      var expected = [
       'Usage: $0',
       '  <regex>  my awesome regex',
       '  <glob>   my awesome     [required]',
       '           glob'
      ]

      ui.toString().split('\n').should.eql(expected)
    ***REMOVED***)

    it('does not apply DSL if wrap is false', function () ***REMOVED***
      var ui = cliui(***REMOVED***
        width: 40,
        wrap: false
      ***REMOVED***)

      ui.div(
        'Usage: $0\ttwo\tthree'
      )

      ui.toString().should.eql('Usage: $0\ttwo\tthree')
    ***REMOVED***)

  ***REMOVED***)
***REMOVED***)
