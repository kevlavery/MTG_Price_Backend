var rng = require('./lib/rng');
var bytesToUuid = require('./lib/bytesToUuid');

function v4(options, buf, offset) ***REMOVED***
  var i = buf && offset || 0;

  if (typeof(options) == 'string') ***REMOVED***
    buf = options === 'binary' ? new Array(16) : null;
    options = null;
  ***REMOVED***
  options = options || ***REMOVED******REMOVED***;

  var rnds = options.random || (options.rng || rng)();

  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`
  rnds[6] = (rnds[6] & 0x0f) | 0x40;
  rnds[8] = (rnds[8] & 0x3f) | 0x80;

  // Copy bytes to buffer, if provided
  if (buf) ***REMOVED***
    for (var ii = 0; ii < 16; ++ii) ***REMOVED***
      buf[i + ii] = rnds[ii];
    ***REMOVED***
  ***REMOVED***

  return buf || bytesToUuid(rnds);
***REMOVED***

module.exports = v4;
