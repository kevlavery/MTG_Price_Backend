var mongoose = require('../../lib');


// import the global schema, this can be done in any file that needs the model
require('./person.js')();

// grab the person model object
var Person = mongoose.model('Person');

// connect to a server to do a quick write / read example

mongoose.connect('mongodb://localhost/persons', function(err) ***REMOVED***
  if (err) ***REMOVED***
    throw err;
  ***REMOVED***

  Person.create(***REMOVED***
    name: 'bill',
    age: 25,
    birthday: new Date().setFullYear((new Date().getFullYear() - 25))
  ***REMOVED***, function(err, bill) ***REMOVED***
    if (err) ***REMOVED***
      throw err;
    ***REMOVED***
    console.log('People added to db: %s', bill.toString());
    Person.find(***REMOVED******REMOVED***, function(err, people) ***REMOVED***
      if (err) ***REMOVED***
        throw err;
      ***REMOVED***

      people.forEach(function(person) ***REMOVED***
        console.log('People in the db: %s', person.toString());
      ***REMOVED***);

      // make sure to clean things up after we're done
      setTimeout(function() ***REMOVED***
        cleanup();
      ***REMOVED***, 2000);
    ***REMOVED***);
  ***REMOVED***);
***REMOVED***);

function cleanup() ***REMOVED***
  Person.remove(function() ***REMOVED***
    mongoose.disconnect();
  ***REMOVED***);
***REMOVED***
