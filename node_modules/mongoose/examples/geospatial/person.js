// import the necessary modules
var mongoose = require('../../lib');
var Schema = mongoose.Schema;

// create an export function to encapsulate the model creation
module.exports = function() ***REMOVED***
  // define schema
  var PersonSchema = new Schema(***REMOVED***
    name: String,
    age: Number,
    birthday: Date,
    gender: String,
    likes: [String],
    // define the geospatial field
    loc: ***REMOVED***type: [Number], index: '2d'***REMOVED***
  ***REMOVED***);

  // define a method to find the closest person
  PersonSchema.methods.findClosest = function(cb) ***REMOVED***
    return this.model('Person').find(***REMOVED***
      loc: ***REMOVED***$nearSphere: this.loc***REMOVED***,
      name: ***REMOVED***$ne: this.name***REMOVED***
    ***REMOVED***).limit(1).exec(cb);
  ***REMOVED***;

  mongoose.model('Person', PersonSchema);
***REMOVED***;
