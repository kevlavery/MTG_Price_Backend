'use strict';

var each = require('async/each');

/*!
 * ignore
 */

module.exports = function(schema) ***REMOVED***
  const unshift = true;
  schema.s.hooks.pre('save', false, function(next) ***REMOVED***
    if (this.ownerDocument) ***REMOVED***
      next();
      return;
    ***REMOVED***

    var _this = this;
    var subdocs = this.$__getAllSubdocs();

    if (!subdocs.length) ***REMOVED***
      next();
      return;
    ***REMOVED***

    each(subdocs, function(subdoc, cb) ***REMOVED***
      subdoc.save(***REMOVED*** suppressWarning: true ***REMOVED***, function(err) ***REMOVED***
        cb(err);
      ***REMOVED***);
    ***REMOVED***, function(error) ***REMOVED***
      if (error) ***REMOVED***
        return _this.schema.s.hooks.execPost('save:error', _this, [_this], ***REMOVED*** error: error ***REMOVED***, function(error) ***REMOVED***
          next(error);
        ***REMOVED***);
      ***REMOVED***
      next();
    ***REMOVED***);
  ***REMOVED***, null, unshift);
***REMOVED***;
