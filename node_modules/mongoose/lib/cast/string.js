'use strict';

const CastError = require('../error/cast');

/*!
 * Given a value, cast it to a string, or throw a `CastError` if the value
 * cannot be casted. `null` and `undefined` are considered valid.
 *
 * @param ***REMOVED***Any***REMOVED*** value
 * @param ***REMOVED***String***REMOVED*** [path] optional the path to set on the CastError
 * @return ***REMOVED***string|null|undefined***REMOVED***
 * @throws ***REMOVED***CastError***REMOVED***
 * @api private
 */

module.exports = function castString(value, path) ***REMOVED***
  // If null or undefined
  if (value == null) ***REMOVED***
    return value;
  ***REMOVED***

  // handle documents being passed
  if (value._id && typeof value._id === 'string') ***REMOVED***
    return value._id;
  ***REMOVED***

  // Re: gh-647 and gh-3030, we're ok with casting using `toString()`
  // **unless** its the default Object.toString, because "[object Object]"
  // doesn't really qualify as useful data
  if (value.toString && value.toString !== Object.prototype.toString) ***REMOVED***
    return value.toString();
  ***REMOVED***

  throw new CastError('string', value, path);
***REMOVED***;
