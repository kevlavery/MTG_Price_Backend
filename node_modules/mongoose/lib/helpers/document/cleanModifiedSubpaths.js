'use strict';

/*!
 * ignore
 */

module.exports = function cleanModifiedSubpaths(doc, path, options) ***REMOVED***
  options = options || ***REMOVED******REMOVED***;
  const skipDocArrays = options.skipDocArrays;

  let deleted = 0;
  for (const modifiedPath of Object.keys(doc.$__.activePaths.states.modify)) ***REMOVED***
    if (skipDocArrays) ***REMOVED***
      const schemaType = doc.schema.path(modifiedPath);
      if (schemaType && schemaType.$isMongooseDocumentArray) ***REMOVED***
        continue;
      ***REMOVED***
    ***REMOVED***
    if (modifiedPath.indexOf(path + '.') === 0) ***REMOVED***
      delete doc.$__.activePaths.states.modify[modifiedPath];
      ++deleted;
    ***REMOVED***
  ***REMOVED***
  return deleted;
***REMOVED***;
