'use strict';

Object.defineProperty(exports, "__esModule", ***REMOVED***
    value: true
***REMOVED***);
exports.default = _eachOfLimit;

var _noop = require('lodash/noop');

var _noop2 = _interopRequireDefault(_noop);

var _once = require('./once');

var _once2 = _interopRequireDefault(_once);

var _iterator = require('./iterator');

var _iterator2 = _interopRequireDefault(_iterator);

var _onlyOnce = require('./onlyOnce');

var _onlyOnce2 = _interopRequireDefault(_onlyOnce);

var _breakLoop = require('./breakLoop');

var _breakLoop2 = _interopRequireDefault(_breakLoop);

function _interopRequireDefault(obj) ***REMOVED*** return obj && obj.__esModule ? obj : ***REMOVED*** default: obj ***REMOVED***; ***REMOVED***

function _eachOfLimit(limit) ***REMOVED***
    return function (obj, iteratee, callback) ***REMOVED***
        callback = (0, _once2.default)(callback || _noop2.default);
        if (limit <= 0 || !obj) ***REMOVED***
            return callback(null);
        ***REMOVED***
        var nextElem = (0, _iterator2.default)(obj);
        var done = false;
        var running = 0;

        function iterateeCallback(err, value) ***REMOVED***
            running -= 1;
            if (err) ***REMOVED***
                done = true;
                callback(err);
            ***REMOVED*** else if (value === _breakLoop2.default || done && running <= 0) ***REMOVED***
                done = true;
                return callback(null);
            ***REMOVED*** else ***REMOVED***
                replenish();
            ***REMOVED***
        ***REMOVED***

        function replenish() ***REMOVED***
            while (running < limit && !done) ***REMOVED***
                var elem = nextElem();
                if (elem === null) ***REMOVED***
                    done = true;
                    if (running <= 0) ***REMOVED***
                        callback(null);
                    ***REMOVED***
                    return;
                ***REMOVED***
                running += 1;
                iteratee(elem.value, elem.key, (0, _onlyOnce2.default)(iterateeCallback));
            ***REMOVED***
        ***REMOVED***

        replenish();
    ***REMOVED***;
***REMOVED***
module.exports = exports['default'];