'use strict';

Object.defineProperty(exports, "__esModule", ***REMOVED***
    value: true
***REMOVED***);
exports.default = transform;

var _isArray = require('lodash/isArray');

var _isArray2 = _interopRequireDefault(_isArray);

var _noop = require('lodash/noop');

var _noop2 = _interopRequireDefault(_noop);

var _eachOf = require('./eachOf');

var _eachOf2 = _interopRequireDefault(_eachOf);

var _once = require('./internal/once');

var _once2 = _interopRequireDefault(_once);

var _wrapAsync = require('./internal/wrapAsync');

var _wrapAsync2 = _interopRequireDefault(_wrapAsync);

function _interopRequireDefault(obj) ***REMOVED*** return obj && obj.__esModule ? obj : ***REMOVED*** default: obj ***REMOVED***; ***REMOVED***

/**
 * A relative of `reduce`.  Takes an Object or Array, and iterates over each
 * element in series, each step potentially mutating an `accumulator` value.
 * The type of the accumulator defaults to the type of collection passed in.
 *
 * @name transform
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param ***REMOVED***Array|Iterable|Object***REMOVED*** coll - A collection to iterate over.
 * @param ***REMOVED*******REMOVED*** [accumulator] - The initial state of the transform.  If omitted,
 * it will default to an empty Object or Array, depending on the type of `coll`
 * @param ***REMOVED***AsyncFunction***REMOVED*** iteratee - A function applied to each item in the
 * collection that potentially modifies the accumulator.
 * Invoked with (accumulator, item, key, callback).
 * @param ***REMOVED***Function***REMOVED*** [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result is the transformed accumulator.
 * Invoked with (err, result).
 * @example
 *
 * async.transform([1,2,3], function(acc, item, index, callback) ***REMOVED***
 *     // pointless async:
 *     process.nextTick(function() ***REMOVED***
 *         acc.push(item * 2)
 *         callback(null)
 *     ***REMOVED***);
 * ***REMOVED***, function(err, result) ***REMOVED***
 *     // result is now equal to [2, 4, 6]
 * ***REMOVED***);
 *
 * @example
 *
 * async.transform(***REMOVED***a: 1, b: 2, c: 3***REMOVED***, function (obj, val, key, callback) ***REMOVED***
 *     setImmediate(function () ***REMOVED***
 *         obj[key] = val * 2;
 *         callback();
 *     ***REMOVED***)
 * ***REMOVED***, function (err, result) ***REMOVED***
 *     // result is equal to ***REMOVED***a: 2, b: 4, c: 6***REMOVED***
 * ***REMOVED***)
 */
function transform(coll, accumulator, iteratee, callback) ***REMOVED***
    if (arguments.length <= 3) ***REMOVED***
        callback = iteratee;
        iteratee = accumulator;
        accumulator = (0, _isArray2.default)(coll) ? [] : ***REMOVED******REMOVED***;
    ***REMOVED***
    callback = (0, _once2.default)(callback || _noop2.default);
    var _iteratee = (0, _wrapAsync2.default)(iteratee);

    (0, _eachOf2.default)(coll, function (v, k, cb) ***REMOVED***
        _iteratee(accumulator, v, k, cb);
    ***REMOVED***, function (err) ***REMOVED***
        callback(err, accumulator);
    ***REMOVED***);
***REMOVED***
module.exports = exports['default'];