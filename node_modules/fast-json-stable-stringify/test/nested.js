'use strict';

var test = require('tape');
var stringify = require('../');

test('nested', function (t) ***REMOVED***
    t.plan(1);
    var obj = ***REMOVED*** c: 8, b: [***REMOVED***z:6,y:5,x:4***REMOVED***,7], a: 3 ***REMOVED***;
    t.equal(stringify(obj), '***REMOVED***"a":3,"b":[***REMOVED***"x":4,"y":5,"z":6***REMOVED***,7],"c":8***REMOVED***');
***REMOVED***);

test('cyclic (default)', function (t) ***REMOVED***
    t.plan(1);
    var one = ***REMOVED*** a: 1 ***REMOVED***;
    var two = ***REMOVED*** a: 2, one: one ***REMOVED***;
    one.two = two;
    try ***REMOVED***
        stringify(one);
    ***REMOVED*** catch (ex) ***REMOVED***
        t.equal(ex.toString(), 'TypeError: Converting circular structure to JSON');
    ***REMOVED***
***REMOVED***);

test('cyclic (specifically allowed)', function (t) ***REMOVED***
    t.plan(1);
    var one = ***REMOVED*** a: 1 ***REMOVED***;
    var two = ***REMOVED*** a: 2, one: one ***REMOVED***;
    one.two = two;
    t.equal(stringify(one, ***REMOVED***cycles:true***REMOVED***), '***REMOVED***"a":1,"two":***REMOVED***"a":2,"one":"__cycle__"***REMOVED******REMOVED***');
***REMOVED***);

test('repeated non-cyclic value', function(t) ***REMOVED***
    t.plan(1);
    var one = ***REMOVED*** x: 1 ***REMOVED***;
    var two = ***REMOVED*** a: one, b: one ***REMOVED***;
    t.equal(stringify(two), '***REMOVED***"a":***REMOVED***"x":1***REMOVED***,"b":***REMOVED***"x":1***REMOVED******REMOVED***');
***REMOVED***);

test('acyclic but with reused obj-property pointers', function (t) ***REMOVED***
    t.plan(1);
    var x = ***REMOVED*** a: 1 ***REMOVED***;
    var y = ***REMOVED*** b: x, c: x ***REMOVED***;
    t.equal(stringify(y), '***REMOVED***"b":***REMOVED***"a":1***REMOVED***,"c":***REMOVED***"a":1***REMOVED******REMOVED***');
***REMOVED***);
